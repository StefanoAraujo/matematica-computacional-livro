== Métodos diretos e iterativos para a resolução de sistemas de equações lineares


.Objetivos do capítulo
____________________
Ao final deste capítulo você deverá ser capaz de:

* Obter facilmente a solução de um sistema de equações linear triangular inferior, ou superior;
* Conhecer os principais métodos de resolução para um sistema de equações linear;
* Aplicar os métodos de decomposição LU e Cholesky;
* Aplicar os métodos de eliminação Gauss com pivotamento diagonal, Gauss com pivotamento parcial, Gauss com pivotamento total e  Gauss-Jordan;
* Refinar uma solução obtida mediante o método de Gauss-Jordan;
* Aplicar os métodos iterativos Jacobi-Richardson e Gauss-Seidel;
* Implementar computacionalmente alguns dos métodos estudados.

____________________

Neste capítulo estudaremos  métodos númericos para resolver sistemas de equações lineares de ordem latexmath:[$n$] que tenham solução única. Lembremos que, tais sistemas são aqueles onde a matriz dos coeficientes tem seu determinante não nulo, isto é, é não singular. Estes métodos podem ser divididos em dois grupos: 

métodos diretos (ou exatos):: São aqueles que fornecem a solução exata, a menos de erros de arredondamento, num númro finito de operações;

métodos iterativos:: são aqueles que geram uma sequência de vetores latexmath:[$\left\{x^{(k)} \right\}$, a partir de uma solução inicial $x^{(0)}$], isto é, através de um processo infinito convergente. Sob certas condições esta sequência converge para a solução do problema, caso ela exista.  

Desta forma, os métodos iterativos têm um erro de truncamento e os exatos não têm. Por outro lado, quando um sistema linear é de grande porte, os erros de arredondamento produzidos pelos métodos exatos podem gerar uma solução sem nenhum significado para o problema dado, enquanto, que nos métodos iterativos os erros de arredodamento não são acumuláveis.  No entanto, ambos métodos apresentam vantagens e desvantagens.

Procuraremos resolver sistemas consistentes através de métodos diretos e iterativos cuja solução seja não nula. Para isso, sempre será  considerado um sitema de equações linear com o vetor de termos independentes sendo não nulo, isto é, latexmath:[$b\neq {\bf 0}$].


=== Métodos diretos

Seja
[latexmath]
++++
\[
Ax=b
\]
++++
um sistema de equações lineares, onde latexmath:[$A$ é uma matriz de ordem $n$, com ${\rm det}(A)\neq 0$, e $b \in \mathbb{R}^n\setminus\{0\}$. Denotemos por $\bar x=(\bar x_1,\dots,\bar x_n)$ o vetor solução deste sistema de equações lineares. Um método direto ou exato é caracterizado por determinar $\bar x$] do sistema dado, num número finito de operações elementares, desprezando os erros de arredondamento provenientes do processamento do algoritmo num equipamento computacional.

==== Solução de sistemas lineares triangulares

Començaremos apresentando como resolver sistemas lineares triangulares, devido a que a solução de este tipo de sistemas é obtida de forma quase direta.


Sistema linear triangular inferior:: 
Seja 
+
[latexmath]
++++
\[
Lx=b
\]
++++
+
um sistema de equações lineares, onde latexmath:[$L=(l_{ij})$ é uma matriz de ordem $n$] triangular inferior, isto é, 
+
[latexmath]
++++
\[
l_{ij}=0,\quad \mbox{para todo }i<j\quad \mbox{e}\quad l_{ii}\neq 0,\quad  \mbox{para todo }i=1,\dots,n
\]
e $b \in \mathbb{R}^n\setminus\{0\}$. Este sistema pode ser reescrito da seguinte maneira:
\[
\begin{array}{cllllllllllllllllllll}
l_{11} x_1 & &         & &     &     &         &&&=&b_1\\
l_{21}x_1  &+&l_{22}x_2& &     &     &         &&&=&b_2\\
\vdots\\
l_{i1}x_1&+&l_{i2}x_2&+&\dots&+    &l_{ii}x_i& &         &=&b_i\\
\vdots\\
l_{n1}x_1&+&l_{n2}x_2&+&\dots&\dots&\dots    &+&l_{nn}x_n&=&b_n
\end{array}
\]
++++
+
Logo, latexmath:[$\bar x=(\bar x_1,\bar x_2,\dots,\bar x_n)$ é obtido por substituição direta, isto é, determinando o valor de $\bar x_1$ da primeira equação, e substituindo este valor na segunda equação, para determinar $\bar x_2$], e assim sucessivamente. Temos, assim, o seguinte algoritmo. +
*Algoritmo 5.1*
+
[latexmath]
++++
\[
\begin{array}{cllllllllllllllllllll}
\bar x_1 & =&\dfrac{b_1}{l_{11}}\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad
\end{array}
\]
Para $i=2,3,\dots,n$ faça
\[
\begin{array}{cllllllllllllllllllll}
\bar x_i & =&\dfrac{b_i-\sum_{k=1}^{n-1}l_{ik}\bar x_k}{l_{ii}}.\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\\
\end{array}
\]
++++

.{zwsp}
====
Calculemos a solução do seguinte sistema de equações lineares:
[latexmath]
++++
\[\begin{bmatrix}
1&0&0\\
2&2&0\\
4&1&3
\end{bmatrix}
\begin{bmatrix}
x_1\\
x_2\\
x_3
\end{bmatrix}=\begin{bmatrix}
1\\
-4
\\
10
\end{bmatrix}
\]
++++
Solução:: Usando o algoritmo anterior, temos:
+
[latexmath]
++++
\[
\begin{array}{rcl}
\bar x_1&=&\dfrac{b_1}{l_{11}}=\dfrac{1}{1}=1\\
\\
\bar x_2&=&\dfrac{b_2-l_{21}\bar x_1}{l_{22}}=\dfrac{-4-2(1)}{2}=-3\\
\\
\bar x_3&=&\dfrac{b_3-(l_{31}\bar x_1+l_{32}\bar x_2)}{l_{22}}=\dfrac{10-(4(1)+1(-3))}{3}=3
\end{array}
\]
++++
+
Portanto, a solução do sistema é
+
[latexmath]
++++
\[
\bar x=(1,-3,3).
\]
++++
====

Sistema linear triangular superior:: 
Seja 
+
[latexmath]
++++
\[
Ux=b
\]
++++
+
um sistema de equações lineares, onde latexmath:[$U=(u_{ij})$ é uma matriz de ordem $n$] triangular superior, isto é, 
+
[latexmath]
++++
\[
u_{ij}=0,\quad \mbox{para todo }i>j\quad \mbox{e}\quad u_{ii}\neq 0,\quad  \mbox{para todo }i=1,\dots,n
\]
e $b \in \mathbb{R}^n\setminus\{0\}$. Este sistema pode ser reescrito da seguinte maneira:
\[
\begin{array}{ccccccccccccccccccc}
u_{11}x_1&+&u_{12}x_2&+&\dots\dots\dots    &+&u_{1n}x_n&=&b_1\\
    &&               &  &                  &   &              & &\vdots\\
         & &       u_{ii}x_i&+&\dots\dots\dots    &+    &u_{in}x_n &=&b_i\\
    &&               &  &                  &   &              & &\vdots\\
&        &&&   u_{(n-1)(n-1)}x_{n-1}&+&u_{(n-1)n}x_{n} &=&b_{n-1}\\
&        &&&   &    &u_{nn}x_n &=&b_n\\

\end{array}
\]
++++
+
Logo, latexmath:[$\bar x=(\bar x_1,\bar x_2,\dots,\bar x_n)$ é obtido por reto-substituição, isto é, determinamos o valor de $\bar x_n$ na última equação, e substituimos este valor na penúltima equação para determinar o valor de $\bar x_{n-1}$], e assim sucessivamente. Temos, assim, o seguinte algoritmo. +
*Algoritmo 5.2*
+
[latexmath]
++++
\[
\begin{array}{llllllllllllllllllll}
\bar x_n & =&\dfrac{b_n}{u_{nn}}\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\\
\end{array}
\]
Para $i=n-1,n-2,\dots,1$ faça
\[
\begin{array}{cllllllllllllllllllll}
\bar x_i & =&\dfrac{b_i-\sum_{k=i+1}^{n}u_{ik}\bar x_k}{u_{ii}}.\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\\
\end{array}
\]
++++

.{zwsp}
====
Calculemos a solução do seguinte sistema de equações lineares:
[latexmath]
++++
\[\begin{bmatrix}
1&2&4\\
0&-4&-2\\
0&0&5
\end{bmatrix}
\begin{bmatrix}
x_1\\
x_2\\
x_3
\end{bmatrix}=\begin{bmatrix}
1\\
6\\
10
\end{bmatrix}
\]
++++
Solução:: Usando o algoritmo anterior, temos:
+
[latexmath]
++++
\[
\begin{array}{rcl}
\bar x_3&=&\dfrac{b_3}{u_{33}}=\dfrac{10}{5}=2;
\\\\
\bar x_2&=&\dfrac{b_2-(u_{23}\bar x_3)}{u_{22}}=\dfrac{6-(-2(2))}{-4}=-2;\\
\\
\bar x_1&=&\dfrac{b_1-(u_{13}\bar x_3+u_{12}\bar x_2)}{u_{11}}=\dfrac{1-(4(2)+2(-2))}{1}=-3.
\end{array}
\]
++++
+
Portanto, a solução do sistema é
+
[latexmath]
++++
\[
\bar x=(-3,-2,2).
\]
++++

====

[NOTE]
====
Desde que o *esforço computacional* de um algoritmo é a quantidade de operações elementares necessárias para calcular a solução do problema para o qual foi desenvolvido. Então, para resolver um sistema triangular inferior, ou superior, de orden latexmath:[$n$], precisamos realizar:

* latexmath:[$n$] operações de divisão;
* latexmath:[$\dfrac{n(n-1)}{2}$] operações de adição (ou substração);
* latexmath:[$\dfrac{n(n-1)}{2}$] operações de multiplicação.

Portanto, o esforço computacional dos *Algoritmos 5.1* e *5.2* é a soma destas operações, isto é:

[latexmath]
++++
\[
n+\dfrac{n(n-1)}{2}+\dfrac{n(n-1)}{2}=n^2.
\] 
++++
====

=== Decomposição LU

Desde que trabalhar com sistemas  de equações lineares triangulares inferiores, ou superiores, apresentam um método de resolução quase direto e o esfoço computacional envolvido é "pequeno", nesta seção veremos como decompor uma matriz quadrada latexmath:[$A=(a_{ij})$ no produto de uma matriz triangular inferior  por uma matriz triangular superior, para que dado o sistema de equações lineares $Ax=b$], este possa ser resolvido utilizando, de forma apropriada, os *Algoritmos 5.1* e *5.2*.

// Estas dos definiciones depues tiene que ir en el capítulo de matrices

Definição 5.1:: Seja latexmath:[$A$ uma matriz de ordem $n$] da forma:
+
[latexmath]
++++
\[
A=\begin{bmatrix}
a_{11}& a_{12}&\dots&a_{1n}\\
a_{21}& a_{22}&\dots&a_{2n}\\
\vdots&\vdots&\ddots&\vdots\\
a_{n1}& a_{n2}&\dots&a_{nn}\\
\end{bmatrix}
\]
Os {\bf menores principais} de $A$, são sub-matrizes quadradas de $A$, de ordens $k=1,2,\dots,n$, denotados por $A_k$,  constituídos pelas $k$ primeiras linhas e as $k$ primeiras colunas de $A$, isto é:
\[
A_k=\begin{bmatrix}
a_{11}& a_{12}&\dots&a_{1k}\\
a_{21}& a_{22}&\dots&a_{2k}\\
\vdots&\vdots&\ddots&\vdots\\
a_{k1}& a_{k2}&\dots&a_{kk}\\
\end{bmatrix}, \qquad k=1,2,\dots,n.
\]
++++


Definição 5.2:: Seja latexmath:[$A$ uma matriz de ordem $n$. Diz-se que $A$ é {\bf definida positiva}, se todos os menores principais de $A$] têm determinante positivo, isto é:
+
[latexmath]
++++
\[
{\rm det}(A_k)>0,\qquad k=1,2,\dots,n.
\]
++++


.{zwsp}
====
Sejam
[latexmath]
++++
\[
A=\begin{bmatrix}
1 & 2 & 2\\
1 & 1 & 3\\
3 & -4 & 0
\end{bmatrix} \quad \mbox{e}\quad B= \begin{bmatrix}
5 & -2 & -3 & 0\\
1 & 4 & -1 & -1\\
2 & -1 & 10 & 0\\
2 & -3 & 1& 5
\end{bmatrix}
\]
++++
Determinemos os menores principais de latexmath:[$A$ e $B$, e se $A$ ou $B$] são matrizes definidas positivas.

Solução:: 
. Para a matriz latexmath:[$A$ temos que ela é de ordem $n=3$, então $k=1,2,3$]. Logo:
+
--
... latexmath:[$A_1=[1\]$, e ${\rm det}(A_1)=1$];

... latexmath:[$A_2=\begin{bmatrix}
1 & 2 \\
1 & 1 \\
\end{bmatrix}$, e ${\rm det}(A_2)=-1$];
 
... latexmath:[$A_3=A=\begin{bmatrix}
1 & 2 & 2\\
1 & 1 & 3\\
3 & -4 & 0
\end{bmatrix}$, e ${\rm det}(A_3)=16$].
--
+
Desde que latexmath:[${\rm det}(A_2)<0$, concluímos que $A$] não é uma matriz definida positiva. 

. Para a matriz latexmath:[$B$ temos que ela é de ordem $n=4$, então $k=1,2,3,4$]. Logo:
+
--
... latexmath:[$B_1=[5\]$, e ${\rm det}(B_1)=5$];

... latexmath:[$B_2=\begin{bmatrix}
5 & -2 \\
1 & 4  \\
\end{bmatrix}$, e ${\rm det}(B_2)=22$];

... latexmath:[$B_3=\begin{bmatrix}
5 & -2 & -3\\
1 & 4 & -1 \\
2 & -1 & 10\\
\end{bmatrix}$, e ${\rm det}(B_3)=246$].
 
... latexmath:[$B_4=B=\begin{bmatrix}
5 & -2 & -3 & 0\\
1 & 4 & -1 & -1\\
2 & -1 & 10 & 0\\
2 & -3 & 1& 5
\end{bmatrix}$, e ${\rm det}(B_4)=1109$].
--
+
Desde que latexmath:[${\rm det}(B_k)>0$, para todo $k=1,2,3,4$, concluímos que $B$] é uma matriz definida positiva.
====

Teorema 5.1 (Teorema LU):: Sejam latexmath:[$A=(a_{ij})$ uma matriz de ordem $n$ e $A_k$ o menor principal de $A$, $k=1,2,\dots,n$. Suponhamos que ${\rm det}(A_k)\neq 0$ para $k=1,2,\dots,n-1$. Então, existe uma única matriz triangular inferior $L=(l_{ij})$, com $l_{11}=l_{22}=\dots=l_{nn}=1$, e uma única matriz triangular superior $U=(u_{ij})$], tal que
+
[latexmath]
++++
\[
LU=A.
\]
Além disso, 
\[
{\rm det}(A)={\rm det}(U)=u_{11}u_{22}\dots u_{nn}.
\]
++++

[NOTE]
====
.. A decomposição obtida no teorema acima, isto é, onde latexmath:[$L$ tem $1$] na diagonal é conhecida também como *Método Doolittle*;

.. A decomposição _LU_ fornece um dos algoritmos mais eficientes para o cálculo do determinante de uma matriz quadrada.

====

==== Processo de secomposição _LU_

Uma das forma de obtermos as matrizes _L_ e _U_, é recorrendo à definição de produto e igualdade de matrizes, ou seja, precisamos impor que latexmath:[$A=LU$. Sejam $A=( a_{ij})$, $L=( l_{ij})$ e $U=( u_{ij})$]. Então, podemos escrever
[latexmath]
++++
\[
\begin{bmatrix}
a_{11}& a_{12}&\dots&a_{1n}\\
a_{21}& a_{22}&\dots&a_{2n}\\
\vdots&\vdots&\ddots&\vdots\\
a_{n1}& a_{n2}&\dots&a_{nn}
\end{bmatrix}=
\begin{bmatrix}
1& \\
l_{21}& 1&0&\\
\vdots&\vdots&\ddots&\\
l_{n1}& l_{n2}&\dots&1\\
\end{bmatrix}
\begin{bmatrix}
u_{11}& u_{12}&\dots&u_{1n}\\
& u_{22}&\dots&u_{2n}\\
&0&\ddots&\vdots\\
& &&u_{nn}
\end{bmatrix}
\] 
++++
e efetuar o produto. Assim, os elementos de $U$ e $L$, são obtidos da seguinte forma:

Matriz _U_::
[latexmath]
++++
\[
u_{ij}=a_{ij}-\sum\limits_{k=1}{i-1}l_{ik}u_{kj},\qquad i,\,j=1,2,\dots,n,\quad i\leq j.
\]
++++

Matriz _L_::
[latexmath]
++++
\[
l_{ij}=\dfrac{a_{ij}-\sum\limits_{k=1}{j-1}l_{ik}u_{kj}}{u_{ij}},\qquad i,\,j=1,2,\dots,n,\quad i> j.
\]
++++
////

=== Atividades

. Resolva os seguintes sistemas de equações lineares triangulares:

... latexmath:[$\quad$]
+
[latexmath]
++++
\[
\begin{array}{rcrcr}
 2x_1  &+&  3x_2   & =& 1\\
    && 7x_2   & =& 3
\end{array}
\]
++++
... latexmath:[$\quad$]
+
[latexmath]
++++ 
\[
\begin{array}{rcrcr}
 4x_1  &&      & =& 5\\
-6x_1  &+& 3x_2   & =& 1
\end{array}
\]
++++
... latexmath:[$\quad$]
+
[latexmath]
++++ 
\[
\begin{array}{rcrcrcr}
2x_1  &+&  3x_2   &-&  2x_3   & =& 5\\
   &&  2x_2   &+&   3x_3   & =& 2\\
   &&      & & 4x_3    & =& 1
\end{array}
\]
++++
... latexmath:[$\quad$]
+
[latexmath]
++++ 
\[
\begin{array}{rcrcrcr}
 x_1  &&      &&      & =& 3\\
2x_1  &+& 3x_2   &&      & =& 4\\
3x_1  &+& 2x_2   &+& 17x_3  & =& 1
\end{array}
\]
++++

... latexmath:[$\quad$]
+
[latexmath]
++++ 
\[
\begin{array}{rcrcrcr}
2 x_1 &&   &&   & =& 3\\
3 x_1 &+& 3 x_2  &&   & =& 12\\
4 x_1 &+& 5 x_2  &-& 2 x_3  & =& 8
\end{array}
\]
++++
... latexmath:[$\quad$]
+
[latexmath]
++++ 
\[
\begin{array}{rcrcrcr}
  x_1 &+& 7 x_2  &-& 7 x_3  & =& 5\\
 && 3 x_2  &+& 3 x_3  & =& 12\\
&&   &-& 4 x_3  & =& 6
\end{array}
\]
++++

... latexmath:[$\quad$]
+
[latexmath]
++++ 
\[
\begin{array}{rcrcrcrcr}
  &&     &&        &-& 2x_4  & =& 0\\
  &&     &&   3x_3    &+& x_4   & =& -4\\
&&   2x_2   &-&   x_3   &+& 3x_4  & =& 5\\
x_1  &+&  2x_2   &+&  2x_3   &-& x_4   & =& 2
\end{array}
\]
++++
... latexmath:[$\quad$]
+
[latexmath]
++++ 
\[
\begin{array}{rcrcrcrcr}
 x_1  &+& 5x_2   &+&  4x_3  &-& 13x_4   & =& 3\\
 &-&  x_2   &+&  2x_3  &+& 5x_4 & =& 2\\
 &&   &-&  4x_3  &+& 3x_4   & =& -5\\
  &&   &&    &-& 4x_4 & =& 1
\end{array}
\]
++++

. Transforme cada um deste sistemas num sistema triangular, inferior ou superior, equivalente e obtenha a sua solução.

... latexmath:[$\quad$]
+
[latexmath]
++++ 
\[
\begin{array}{rcrcrcr}
2 x_1 &+& 5 x_2  &-& 2 x_3  & =& 3\\
3 x_1 &+& 3 x_2  &+& 3 x_3  & =& 12\\
- x_1 &+&  x_2  &+&  x_3  & =& 6
\end{array}
\]
++++
... latexmath:[$\quad$]
+
[latexmath]
++++ 
\[
\begin{array}{rcrcrcr}
  x_1 &+& 7 x_2  &-& 7 x_3  & =& 5\\
3 x_1 &+&  x_2  &+& 3 x_3  & =& 12\\
4 x_1 &+& 10 x_2  &-& 4 x_3  & =& 6
\end{array}
\]
++++
... latexmath:[$\quad$]
+
[latexmath]
++++ 
\[
\begin{array}{rcrcrcr}
2 x_1 &+& 5 x_2  &+& 6 x_3  & =& 1\\
3 x_1 &-& 6 x_2  &+& 9 x_3  & =& 0\\
 7 x_1 &+&1 x_2  &-& 7 x_3  & =& 5\\
\end{array}
\]
++++
... latexmath:[$\quad$]
+
[latexmath]
++++ 
\[
\begin{array}{rcrcrcr}
  x_1 &+& 2 x_2  &+& 3 x_3  & =& 3\\
2 x_1 &+&   x_2  &+& 3 x_3  & =& 4\\
3 x_1 &+& 2 x_2  &+&   x_3  & =& 5
\end{array}
\]
++++
... latexmath:[$\quad$]
+
[latexmath]
++++ 
\[
\begin{array}{rcrcrcrcrcr}
x_1 &-& x_2 &+& x_3 &-&x_4&&&=& 3\\
x_1 &-& x_2 &-& 3x_3&&&-&3x_5 &=& -3\\
&-&x_2 &&&+& x_4 &+& x_5 &=& 1\\
3x_1 &+& 3x_2 &-& 5x_3&&&& &=& 0\\
3x_1 &+& 2x_2 &-& 4x_3&+& 2x_4 &-&3 x_5  &=& 1
\end{array}
\]
++++
... latexmath:[$\quad$]
+
[latexmath]
++++ 
\[\begin{array}{rcrcrcrcr}
2 x_1 &+& 2 x_2  &+&  2 x_3 &+& 2 x_4 & =& 0\\
 x_1 &+&  x_2  &+&   x_3 &-&  x_4& =& 4\\
 x_1 &+&  x_2  &-&   x_3 &+&  x_4& =& -4\\
 x_1 &-&  x_2  &+&   x_3 &+&  x_4& =& 2
\end{array}
\]
++++
... latexmath:[$\quad$]
+
[latexmath]
++++ 
\[\begin{array}{rcrcrcr}
 x_1  &+&  2 x_2  &+&  3 x_3  & =& 5\\
2 x_1 &-&  x_2  &+&   4 x_3  & =& 11\\
   &-&  x_2   &+&  x_3   & =& 3
\end{array}
\]
++++
... latexmath:[$\quad$]
+
[latexmath]
++++ 
\[
\begin{array}{rcrcrcr}
 x_1  &+&   x_2  &+&  2 x_3  & =& 4\\
3 x_1 &-&  x_2  &-&    x_3  & =& 2\\
2 x_1 &+& 5 x_2   &+& 3 x_3   & =& 3
\end{array}
\]
++++
... latexmath:[$\quad$]
+
[latexmath]
++++ 
\[
\begin{array}{rcrcrcr}
 x_1  &+&   x_2  &&    & =& 5\\
 x_1 && &+&    x_3  & =& 2\\
   &&  x_2   &+&  x_3   & =& 5
\end{array}
\]
++++

... latexmath:[$\quad$]
+
[latexmath]
++++ 
\[\begin{array}{rcrcrcr}
 x_1  &-&  2 x_2  &+&   x_3  & =& 1\\
2 x_1 &+&   x_2 &&        & =& 3\\
   &&  x_2   &-& 5 x_3   & =& 4
\end{array}
\]
++++
////


